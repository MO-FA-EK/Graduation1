<div class="admin-container">
  <aside class="sidebar">
    <h3>Admin Panel</h3>
    <nav>
      <button [class.active]="activeTab === 'users'" (click)="setTab('users')">ğŸ‘¥ Users</button>
      <button [class.active]="activeTab === 'projects'" (click)="setTab('projects')">ğŸš€ Projects</button>
      <button [class.active]="activeTab === 'messages'" (click)="setTab('messages')">ğŸ“© Messages <span class="badge" *ngIf="messages.length">{{ messages.length }}</span></button>
      <button [class.active]="activeTab === 'security'" (click)="setTab('security')">ğŸ”’ Security</button>
      <button class="logout-btn" (click)="logout()">ğŸšª Logout</button>
    </nav>
  </aside>

  <main class="content">
    <div class="stats-row">
      <div class="stat-card">
        <h3>Freelancers</h3>
        <p>{{ stats.freelancers }}</p>
      </div>
      <div class="stat-card">
        <h3>Clients</h3>
        <p>{{ stats.clients }}</p>
      </div>
      <div class="stat-card">
        <h3>Projects</h3>
        <p>{{ stats.projects }}</p>
      </div>
      <div class="stat-card">
        <h3>Messages</h3>
        <p>{{ stats.messages }}</p>
      </div>
    </div>

    <div *ngIf="activeTab === 'users'" class="tab-content fade-in">
      <h2>Manage Users</h2>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Type</th>
            <th>Email</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let u of users">
            <td>{{ u.id }}</td>
            <td>{{ u.username }}</td>
            <td>{{ u.user_type }}</td>
            <td>{{ u.email }}</td>
            <td>
              <button class="delete-btn" (click)="deleteUser(u.id)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="activeTab === 'projects'" class="tab-content fade-in">
      <h2>Manage Projects</h2>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Client</th>
            <th>Title</th>
            <th>Freelancer</th>
            <th>Status</th>
            <th>Payment</th>
            <th>Amount</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of projects">
            <td>{{ p.id }}</td>
            <td>{{ p.client_name }}</td>
            <td>{{ p.title }}</td>
            <td>{{ p.freelancer_name || 'N/A' }}</td>
            <td>{{ p.status }}</td>
            <td>
              <span *ngIf="p.is_paid" class="badge success">Paid</span>
              <span *ngIf="!p.is_paid" class="badge warning">Unpaid</span>
            </td>
            <td>${{ p.amount }}</td>
            <td>
              <button class="delete-btn" (click)="deleteProject(p.id)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="activeTab === 'messages'" class="tab-content fade-in">
      <h2>User Messages</h2>
      
      <div *ngIf="messages.length === 0" class="empty-state">
        <p>No messages available.</p>
      </div>

      <div class="messages-list">
        <div *ngFor="let msg of messages" class="message-card">
          <div class="msg-header">
            <span class="sender-name">ğŸ‘¤ {{ msg.name }}</span>
            <span class="msg-date">ğŸ•’ {{ msg.created_at | date:'short' }}</span>
          </div>
          <div class="msg-email">âœ‰ï¸ {{ msg.email }}</div>
          <div class="msg-body">
            {{ msg.message }}
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="activeTab === 'security'" class="tab-content fade-in">
      <h2>Change Admin Password</h2>
      <div class="form-group">
        <input type="password" [(ngModel)]="passData.old_password" placeholder="Old Password">
        <input type="password" [(ngModel)]="passData.new_password" placeholder="New Password">
        <input type="password" [(ngModel)]="passData.confirm_password" placeholder="Confirm Password">
        <button (click)="changePasswordSubmit()">Update Password</button>
      </div>
      <p [class.error]="isPassError" [class.success]="!isPassError">{{ passMessage }}</p>
    </div>

  </main>
</div>